"use strict";let gs_moto_space=exports;var MOTO=window.moto=window.moto||{};!function(){let e,n,t,i,o,s,a,l,r,c,u,d,f,p,E,h,y,w,m,T,v,H,R,b,x,g,M,z,G=window,k=document,S=new THREE.Scene,D=new THREE.Group,C=D.children,P=Math.PI,Z=P/2,B=P/4,L=Math.round,O=0,X=0,Y=0,j=null,A=!1,U=!1,V=!0,W=!1,K=!1,N=12303291,q=13421772,I=!0,_=!0,F=!0,J=pe(0,0,0,.3/3),Q={x:0,y:0,z:0},$={x:0,y:0},ee=null,ne=null,te=null,ie=!1,oe=!1,se=new THREE.MeshPhongMaterial({color:13421772,specular:13421772,shininess:5,transparent:!0,opacity:.6,side:THREE.DoubleSide}),ae=!0;function le(e){new TWEEN.Tween(u.getPosition()).to(e,500).onUpdate(function(){u.setPosition(this),we()}).start()}function re(){return G.innerWidth}function ce(){return G.innerHeight}function ue(){return re()/ce()}function de(e,n,t){e.addEventListener(n,t)}function fe(e,n){for(let t=0;t<n.length;t+=2)de(e,n[t],n[t+1])}function pe(e,n,t,i){let o=new THREE.PointLight(16777215,i,0);return o.position.set(e,n,t),S.add(o),o}function Ee(){f.position.y=oe?-f.scale.y/2-Y:-f.scale.z/2-Y,me()}function he(e,n,t){oe?f.scale.set(e||300,t||5,n||175):f.scale.set(e||300,n||175,t||5),u.maxDistance=4*Math.max(e,n),Ee();let i=1*Math.max(e,t);m.position.set(e,i,n),T.position.set(-e,i,-n),H.position.set(e,H.position.y,-n),R.position.set(-e,R.position.y,n)}function ye(e,n,t,i){if(!e)return;let o=c;c=new THREE.Group,a=e,s=n,l=t||l,r=i||r;let u,d=f.scale.x,p=oe?f.scale.z:f.scale.y,E=oe?f.scale.y:f.scale.z,h=L(d/e)*e,y=L(p/e)*e,w=oe?Math.floor(d/2):Math.ceil(h/2),m=oe?Math.floor(p/2):Math.ceil(y/2),T=d/2,v=p/2,H=-(E/2)-Y+X,R=[],b=n?[]:null;for(u=-w;u<=w;u++)if(u>=-T&&u<=T){let t=oe?Math.sqrt(1-u/w*(u/w))*v:v;u%e==0?R.append({x:u,y:-t,z:H}).append({x:u,y:t,z:H}):b&&u%n==0&&b.append({x:u,y:-t,z:H}).append({x:u,y:t,z:H})}for(u=-m;u<=m;u++)if(u>=-v&&u<=v){let t=oe?Math.sqrt(1-u/m*(u/m))*T:T;u%e==0?R.append({x:-t,y:u,z:H}).append({x:t,y:u,z:H}):b&&u%n==0&&b.append({x:-t,y:u,z:H}).append({x:t,y:u,z:H})}c.add(Re(R,l||10066329,1)),b&&c.add(Re(b,r||13421772,1)),o&&ze.scene.remove(o),ze.scene.add(c)}function we(){A=!1,u.update()}function me(e){!1===A&&(A=!0,clearTimeout(j),j=setTimeout(we,e||10))}function Te(){b.aspect=ue(),b.updateProjectionMatrix(),x.setSize(re(),ce()),g.style.width=re(),g.style.height=ce(),me()}function ve(e){return e.charCodeAt(0)}function He(e){if(!V||k.activeElement&&k.activeElement!=k.body)return!1;if(e.metaKey)return!1;let n=!0;switch(e.charCode){case ve("z"):ze.view.reset();break;case ve("h"):ze.view.home();break;case ve("f"):ze.view.front();break;case ve("l"):ze.view.left();break;case ve("r"):ze.view.right();break;case ve("t"):ze.view.top();break;case ve("b"):ze.view.back();break;default:n=!1}return n&&e.preventDefault(),!1}function Re(e,n,t){if(e.length%2!=0)throw"invalid line : "+e.length;let i,o,s,a=new THREE.Geometry,l=0;for(;l<e.length;)i=e[l++],o=e[l++],a.vertices.push(new THREE.Vector3(i.x,i.y,i.z)),a.vertices.push(new THREE.Vector3(o.x,o.y,o.z));return a.verticesNeedUpdate=!0,s=new THREE.LineSegments(a,new THREE.LineBasicMaterial({color:n,linewidth:t||1}))}function be(e,n){let t=new THREE.Vector3($.x,$.y,0).unproject(b);return new THREE.Raycaster(b.position,t.sub(b.position).normalize()).intersectObjects(e,n)}function xe(n){if(n.target===x.domElement){k.activeElement.blur(),n.preventDefault();let t=null,i=K?d:f,o=i.visible;if(e&&(t=e()),t&&t.length>0){i.visible=!0;let s=be(t.slice().append(i),!1);if(i.visible=o,s.length>0){let o,a;for(let e=0;e<s.length;e++)o||s[e].object!==i?!a&&t.contains(s[e].object)&&(a=s[e]):o=s[e];o&&a&&(ne=o.point.clone(),te=ne,u.enabled=!1),a&&e(a,n)}}if(E){let e=f.visible;f.visible=!0;let n=be([f],!1);f.visible=e,h=n&&n.length>0?n[0].point:null}}else u.enabled=!1;ee={x:n.clientX/re()*2-1,y:-n.clientY/ce()*2+1}}function ge(e){u.enabled||(u.enabled=!0,u.onMouseUp(e));let t=e.clientX/re()*2-1,o=-e.clientY/ce()*2+1;if(t-ee.x+o-ee.y==0){e.preventDefault();let t=!1,i=null;if(n&&(i=n()),i&&i.length>0){let o=be(i,U);o.length>0?(n(o[0],e),t=!0):n(null,e)}!t&&h&&E(h),t&&me()}else i&&te&&i(null,null,!0);ne=null,te=null}function Me(e){let n,o;if(u.enabled){e.preventDefault();let i=t?t():null;i&&i.length>0&&(n=be(i,U)).length>0&&t(n[0],e),n&&0!=n.length||!p||(o=f.visible,f.visible=!0,n=be([f],!1),f.visible=o,n&&n.length>0&&p(n[0].point))}else if(ne&&i&&i()){e.preventDefault();let t=K?d:f,o=t.visible;if(t.visible=!0,n=be([t],!1),t.visible=o,n.length>0&&n[0].object===t){let e=ne.clone().sub(n[0].point),t=te.clone().sub(n[0].point);ne=n[0].point,i({x:-e.x,y:e.z},t.multiplyVectors(t,Q)),me()}}$={x:e.clientX/re()*2-1,y:-e.clientY/ce()*2+1}}void 0!==k.hidden?(M="hidden",z="visibilitychange"):void 0!==k.msHidden?(M="msHidden",z="msvisibilitychange"):void 0!==k.webkitHidden&&(M="webkitHidden",z="webkitvisibilitychange"),k.addEventListener(z,()=>{ae=!k[M]},!1),function e(){TWEEN.update(),setTimeout(e,20)}();let ze=MOTO.Space={alignTracking:function(e,n,t){e&&n?(K=!0,d.position.set(e.x,e.y,e.z),d.rotation.set(n.x,n.y,n.z),Q=t):(K=!1,d.position.set(0,0,0),d.rotation.set(Z,0,0))},addEventListener:de,addEventHandlers:fe,onEnterKey:function e(n,t){if(Array.isArray(n))for(let t=0;t<n.length;t+=2)e(n[t],n[t+1]);else de(n,"keyup",function(e){13===e.keyCode&&t(e)})},onResize:Te,update:me,refresh:we,showSkyGrid:function(e){I=e},setSkyColor:function(e){N=e},setSkyGridColor:function(e){q=e},scene:{add:function(e){return e.rotation.x=D.rotation.x,S.add(e)},remove:function(e){return S.remove(e)},freeze:function(e){let n=ie;return ie=e,n}},platform:{tweenTo:function(e,n,t){let i={x:f.scale.x,y:f.scale.y,z:f.scale.z},o={x:e,y:n,z:t},c=a,u=s;new TWEEN.Tween(i).to(o,500).onStart(function(){ye(0)}).onUpdate(function(){he(this.x,this.y,this.z),we()}).onComplete(function(){ye(c,u,l,r)}).start()},setSize:function(e,n,t){he(e,n,t),ye(a,s)},setColor:function(e){let n=f.material.color.getHex();return f.material.color.set(e),me(),n},setOrigin:function(e,n,t){if(o){if(e===o.x&&n===o.y&&t===o.z)return;ze.scene.remove(o.group)}if(void 0===e)return o=null,void ze.update();let i,s,a,l,r=new THREE.MeshPhongMaterial({color:13430527,specular:13430527,shininess:5,transparent:!0,opacity:.5,side:THREE.DoubleSide}),c=new THREE.MeshPhongMaterial({color:8956637,transparent:!0,opacity:.5,side:THREE.DoubleSide}),u=Math.PI/2,d=new THREE.Group;o={x:e,y:n,z:t,group:d},d.add(i=new THREE.Mesh(new THREE.CircleGeometry(4.6,50,0*u,1*u),r)),i.position.x=.25,i.position.y=.25,d.add(s=new THREE.Mesh(new THREE.CircleGeometry(4.6,50,1*u,1*u),r)),s.position.x=-.25,s.position.y=.25,d.add(a=new THREE.Mesh(new THREE.CircleGeometry(4.6,50,2*u,1*u),r)),a.position.x=-.25,a.position.y=-.25,d.add(l=new THREE.Mesh(new THREE.CircleGeometry(4.6,50,3*u,1*u),r)),l.position.x=.25,l.position.y=-.25,d.add(new THREE.Mesh(new THREE.RingGeometry(5,5.5,50),c)),d.add(new THREE.Mesh(new THREE.PlaneGeometry(.5,10),c)),d.add(new THREE.Mesh(new THREE.PlaneGeometry(10,.5),c)),d.rotation.x=-Z,d.position.x=e,d.position.y=t,d.position.z=n,ze.scene.add(d),ze.update()},setGrid:ye,add:function(e){D.add(e)},remove:function(e){D.remove(e)},setMaxZ:function(e){O=e/2},isHidden:function(){return!_},setHidden:function(e){_=!e,f.visible=!e},setHiding:function(e){F=e},setZOff:function(e){Y=e,Ee()},setGZOff:function(e){X=e,Ee()},opacity:function(e){f.material.opacity=e},onMove:function(e){y=e},onHover:function(e){p=e},onClick:function(e){E=e},size:function(){return f.scale},isVisible:function(){return f.visible},showGrid:function(e){c.visible=e},setRound:function(e){let n=f;oe=e,e?(f=new THREE.Mesh(new THREE.CylinderGeometry(.5,.5,1,60),se)).rotation.x=0:(f=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),se)).rotation.x=-Z,f.position.y=n.position.y,f.visible=n.visible,S.remove(n),S.add(f)},world:D},view:{top:function(){le({left:0,up:0,panX:0,panY:O,panZ:0})},back:function(){le({left:P,up:Z,panX:0,panY:O,panZ:0})},home:function(){le({left:0,up:B,panX:0,panY:O,panZ:0})},front:function(){le({left:0,up:Z,panX:0,panY:O,panZ:0})},right:function(){le({left:Z,up:Z,panX:0,panY:O,panZ:0})},left:function(){le({left:-Z,up:Z,panX:0,panY:O,panZ:0})},reset:function(){u.reset(),me()},load:function(e){u.setPosition(e)},save:function(){return u.getPosition(!0)},panTo:function(e,n,t){!function(e,n,t){let i=u.getPosition();i.panX=e,i.panY=n,i.panZ=t,le(i)}(e,n,t)},setZoom:function(e,n){u.setZoom(e,n)}},mouse:{downSelect:function(n){e=n},upSelect:function(e){n=e},onDrag:function(e){i=e},onHover:function(e){t=e}},useDefaultKeys:function(e){V=e},selectRecurse:function(e){U=e},objects:function(){return C},screenshot:function(e){return x.domElement.toDataURL(e||"image/png")},init:function(e,n){g=e,D.rotation.x=-Z,S.add(D),e.style.width=re(),e.style.height=ce(),x=new THREE.WebGLRenderer({antialias:!0,preserveDrawingBuffer:!0}),(b=new THREE.PerspectiveCamera(35,ue(),5,1e5)).position.set(0,200,340),x.setSize(re(),ce()),e.appendChild(x.domElement),(u=new MOTO.CTRL(b,e,function(e,n){f&&(f.visible=F?W&&e.y>=0&&_:_),J&&J.position.copy(b.position),n&&y&&(clearTimeout(w),w=setTimeout(y,500))},n)).noKeys=!0,u.maxDistance=1e3,S.add(new THREE.AmbientLight(7368816)),m=pe(200,250,200,.345),T=pe(-200,250,-200,.285),v=pe(0,-200,0,.15),H=pe(200,5,-200,.105),R=pe(-200,5,200,.12),(f=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),se)).position.y=Y,f.rotation.x=-Z,f.visible=_,(d=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e5,1e5,1,1),new THREE.MeshBasicMaterial({color:7829367,opacity:0,transparent:!0,side:THREE.DoubleSide}))).visible=!1,d.rotation.x=Z;let t=new THREE.Mesh(new THREE.BoxGeometry(5e4,5e4,5e4,1,1,1),new THREE.MeshBasicMaterial({color:N,side:THREE.DoubleSide})),i=new THREE.Mesh(new THREE.BoxGeometry(5e3,5e3,5e3,10,10,10),new THREE.MeshBasicMaterial({color:q,side:THREE.DoubleSide}));S.add(f),S.add(d),S.add(t),I&&(i.material.wireframe=!0,S.add(i)),fe(G,["resize",Te,"mousemove",Me,"mousedown",xe,"mouseup",ge,"keypress",He]),function e(){requestAnimationFrame(e),ae&&!ie&&x.render(S,b)}(),W=!0}}}();