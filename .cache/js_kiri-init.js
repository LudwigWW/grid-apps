"use strict";var gs_kiri_init=exports;!function(){if(self.kiri||(self.kiri={}),self.kiri.init)return;let e,t=self.kiri,o=(self.moto,t.conf),l=self.window,n=self.document,s=self.location,a=t.api,i=a.sdb,r=a.ui,c=a.uc,d=a.const.SEED,u=a.const.LANG,p=a.const.VIEWS,_=a.const.MODES,m=a.const.LOCAL,f=a.const.SETUP,v=(f.dm&&1===f.dm.length&&f.dm[0],f.sm&&1===f.sm.length?f.sm[0]:null),w=t.space,h=a.stats,g=Math.PI/180,b=[_.FDM,_.LASER,_.CAM,_.SLA],y=[_.CAM],k=[_.SLA],x=[_.FDM],I=[_.FDM,_.SLA],S=[_.CAM,_.FDM],F=[_.LASER,_.FDM],B=(_.LASER,_.FDM,_.SLA,[_.LASER,_.CAM]),T=[_.FDM,_.LASER,_.CAM],L=[_.LASER],z=a.catalog,A=a.platform,D=(a.selection,!1),O=a.js2o,C=(a.o2js,null),E=null,M=0;function R(){return a.conf.get()}function N(){let e=R().controller,t=e.compact,o=e.dark,l=!1;e.expert=r.expert.checked,e.showOrigin=r.showOrigin.checked,e.autoLayout=r.autoLayout.checked,e.freeLayout=r.freeLayout.checked,e.alignTop=r.alignTop.checked,e.reverseZoom=r.reverseZoom.checked,e.compact=r.compact.checked,e.dark=r.dark.checked,w.view.setZoom(e.reverseZoom,e.zoomSpeed),A.layout(),A.update_stock(),a.conf.save(),t!==e.compact&&(c.setDefaults(t),l=!0),o!==e.dark&&(l=!0),a.mode.set_expert(e.expert),l&&a.space.reload()}function G(){a.conf.update(),a.show.slices()}function P(){a.conf.update(),n.activeElement.blur()}function H(){let e=n.activeElement;return e&&("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName)}function Z(e){return e.charCodeAt(0)}function j(e){if(!a.feature.on_key||!a.feature.on_key({up:e})){switch(e.keyCode){case 27:n.activeElement.blur(),a.modal.hide(),A.deselect(),a.dialog.hide(),t.work.isSlicing()&&t.work.restart(),c.hidePoppers(),r.layers.style.display="none"}return!1}}function X(e){if(a.modal.visible())return!1;if(a.feature.on_key&&a.feature.on_key({down:e}))return;let t=e.altKey?5:0,o=t?0:-Math.PI/(e.shiftKey?36:2);switch(e.keyCode){case 8:case 46:if(H())return!1;A.delete(a.selection.meshes()),e.preventDefault();break;case 37:if(H())return!1;o&&a.selection.rotate(0,0,-o),t>0&&moveSelection(-t,0,0),e.preventDefault();break;case 39:if(H())return!1;o&&a.selection.rotate(0,0,o),t>0&&moveSelection(t,0,0),e.preventDefault();break;case 38:if(H())return!1;if(e.metaKey)return a.show.layer(a.var.layer_at+1);o&&a.selection.rotate(o,0,0),t>0&&moveSelection(0,t,0),e.preventDefault();break;case 40:if(H())return!1;if(e.metaKey)return a.show.layer(a.var.layer_at-1);o&&a.selection.rotate(-o,0,0),t>0&&moveSelection(0,-t,0),e.preventDefault();break;case 65:if(e.metaKey){if(H())return!1;e.preventDefault(),A.deselect(),A.select_all()}break;case 83:e.ctrlKey?(e.preventDefault(),a.conf.save(),log("settings saved")):e.metaKey&&(e.preventDefault(),a.space.save());break;case 76:e.metaKey&&(e.preventDefault(),a.space.restore())}}function Y(e){let t,o,l,n,c,d=!0,u=R();e.charCode;if(a.modal.visible()||H())return!1;if(!a.feature.on_key||!a.feature.on_key({key:e})){switch(e.charCode){case Z("`"):a.show.slices(0);break;case Z("0"):a.show.slices(a.var.layer_max);break;case Z("1"):e.ctrlKey?(t=r.ctrlLeft.style).display="none"===t.display?"block":"none":a.show.slices(a.var.layer_max/10);break;case Z("2"):e.ctrlKey?(t=r.ctrlRight.style).display="none"===t.display?"block":"none":a.show.slices(2*a.var.layer_max/10);break;case Z("3"):e.ctrlKey?(t=!w.platform.isHidden(),w.platform.setHidden(t),w.platform.showGrid(!t),w.update()):a.show.slices(3*a.var.layer_max/10);break;case Z("4"):a.show.slices(4*a.var.layer_max/10);break;case Z("5"):a.show.slices(5*a.var.layer_max/10);break;case Z("6"):a.show.slices(6*a.var.layer_max/10);break;case Z("7"):a.show.slices(7*a.var.layer_max/10);break;case Z("8"):a.show.slices(8*a.var.layer_max/10);break;case Z("9"):a.show.slices(9*a.var.layer_max/10);break;case Z("?"):a.help.show();break;case Z("Z"):confirm("clear all settings?")&&i.clear();break;case Z("C"):z.refresh();break;case Z("i"):let p=prompt('edit "'+u.process.processName+'"',JSON.stringify(u.process));if(p)try{u.process=JSON.parse(p),a.view.update_fields()}catch(e){console.log(e),a.show.alert("invalid settings format")}break;case Z("U"):!function(e){let t=btoa(JSON.stringify(R()));new moto.Ajax(function(t){if(t){let o=JSON.parse(t);o&&o.ver&&(s.hash=o.space+"/"+o.ver,e&&alert("unique settings id is: "+o.space+"/"+o.ver))}else updateSpaceState()}).request("/data/"+R().id+"/"+R().ver,t)}(!0);break;case Z("u"):K(prompt("settings id to load"));break;case Z("s"):a.function.slice();break;case Z("p"):"SLA"!==a.mode.get()&&a.function.print();break;case Z("P"):!function(){if(0===a.selection.meshes().length)return void a.show.alert("select object to position");let e=R(),t=e.process.outputOriginCenter,o=boundsSelection(),l=prompt("Enter X,Y coordinates for selection").split(","),n=parseFloat(l[0]||0),s=parseFloat(l[1]||0),i=parseFloat(l[2]||0);t||(n=n-e.device.bedWidth/2+(o.max.x-o.min.x)/2,s=s-e.device.bedDepth/2+(o.max.y-o.min.y)/2);moveSelection(n,s,i,!0)}();break;case Z("R"):!function(){if(0===a.selection.meshes().length)return void a.show.alert("select object to rotate");let e=prompt("Enter X,Y,Z degrees of rotation").split(","),t=Math.PI/180,o=parseFloat(e[0]||0)*t,l=parseFloat(e[1]||0)*t,n=parseFloat(e[2]||0)*t;a.selection.rotate(o,l,n)}();break;case Z("x"):a.function.export();break;case Z("e"):de();break;case Z("o"):ce();break;case Z("c"):a.show.local();break;case Z("v"):r.layerRange.checked=!r.layerRange.checked,a.show.slices();break;case Z("d"):for(o=a.selection.meshes(),A.deselect(),l=0;l<o.length;l++){(n=o[l].clone()).geometry=n.geometry.clone(),n.material=n.material.clone(),c=n.getBoundingBox();let e=a.widgets.new().loadGeometry(n.geometry);e.move(c.max.x-c.min.x+1,0,0),A.add(e,!0)}break;case Z("m"):a.selection.for_widgets(function(e){e.mirror()}),w.update();break;case Z("R"):renderMode++,a.function.slice();break;case Z("a"):A.layout();break;case Z("w"):a.view.wireframe(a.color.wireframe,a.color.wireframe_opacity);break;default:a.event.emit("keypress",e),d=!1}return d&&e.preventDefault(),!1}}function K(e){let t=(e||s.hash.substring(1)).split("/");2===t.length&&new moto.Ajax(function(e){if(e){let t=JSON.parse(e);if(t&&t.ver&&t.rec){let e=JSON.parse(atob(t.rec));e.id=t.space,e.ver=t.ver,a.conf.put(e),a.event.settings(),s.hash=""}}}).request("/data/"+t[0]+"/"+t[1])}function W(){let e=l.prompt("Download Settings Filename","kiriconf");if(!e)return;let t=a.conf.export(),o=new Blob([t],{type:"octet/stream"}),n=l.URL.createObjectURL(o);$("help").innerHTML=`<a id="sexport" href="${n}" download="${e}.b64">x</a>`,$("sexport").click()}function J(){a.dialog.hide();let e=a.mode.get(),t=R(),o=t.process,n=t.sproc[e],s=l.prompt("Save Settings As",o&&o.processName||"default");if(!s)return;let i=n[s]={};o.processName=s;for(let e in o)o.hasOwnProperty(e)&&(i[e]=o[e]);t.cproc[a.mode.get()]=s,a.conf.save(),a.event.settings()}function U(){a.conf.show()}function V(e){return!!R().devices[e]}function q(){return r.deviceSelect.options[r.deviceSelect.selectedIndex].text}function Q(e,t){D=t,t&&(r.setupDevices.style.display="none"),V(e)?te(R().devices[e],e):a.ajax("/kiri/filter/"+a.mode.get()+"/"+e,function(t){te(t,e)}),$("selected-device").innerHTML=e}function ee(){let e=`${q()}.copy`,t=a.clone(R().device);var o,l;t.mode=a.mode.get(),o=e,l=t,R().devices[o]=l,a.conf.save(),te(t,e)}function te(e,t){try{"string"==typeof e&&(e=O(e)||{}),a.event.emit("device.set",t);let l=a.mode.get(),s=R(),i=V(t),c=s.devproc[t],d=s.device=o.device_from_code(e,l),u=s.process;if(d.new=!1,d.deviceName=t,u.outputOriginCenter=d.outputOriginCenter,r.deviceName.value=t,r.deviceOrigin.checked=u.outputOriginCenter,d.extruders){let e=a.lists.extruders=[];d.internal=0;let t=$("sel-ext");t.innerHTML="";for(let o=d.extruders.length-1;o>=0;o--){let l=n.createElement("button");l.appendChild(n.createTextNode(o)),l.setAttribute("id",`sel-ext-${o}`),l.onclick=function(){a.selection.for_widgets(e=>{s.widget[e.id]={extruder:o}}),a.platform.update_selected()},t.appendChild(l),e.push({id:o,name:o})}}"CAM"===l&&(u.camOriginTop=d.outputOriginTop),[r.deviceName,r.gcodePre,r.gcodePost,r.gcodePause,r.bedDepth,r.bedWidth,r.maxHeight,r.extrudeAbs,r.deviceOrigin,r.deviceOriginTop,r.deviceRound,r.gcodeFan,r.gcodeTrack,r.gcodeLayer,r.extFilament,r.extNozzle,r.deviceMaxSpindle,r.gcodeSpindle,r.gcodeDwell,r.gcodeChange,r.gcodeFExt,r.gcodeSpace,r.gcodeStrip,r.gcodeLaserOn,r.gcodeLaserOff,r.extPrev,r.extNext,r.extAdd,r.extDel,r.extOffsetX,r.extOffsetY,r.extSelect].forEach(function(e){e.disabled=!i}),"CAM"===l&&[r.extrudeAbs,r.roughingSpindle,r.finishingSpindle,r.drillSpindle].forEach(function(e){e.parentNode.style.display=d.spindleMax>=0?"none":"block"}),r.deviceSave.disabled=!i,r.deviceDelete.disabled=!i,r.deviceAdd.disabled=d.noclone,a.view.update_fields(),A.update_size(),s.filter[l]=t,s.cdev[l]=d,c&&a.conf.load(null,c),a.conf.save()}catch(o){throw console.log({error:o,device:e,devicename:t}),a.show.alert(`invalid or deprecated device: "${t}"`,10),a.show.alert("please select a new device",10),o}a.function.clear(),a.event.settings()}function oe(){let e=r.deviceName.value,t=a.device.get(),o=R().devices;e!==t&&(o[e]=o[t],delete o[t],r.deviceSave.onclick(),Q(e))}function le(e){r.devices.onclick=c.hidePop,c.hidePop();let t=-1,o=a.device.get(),l=R().devices;for(let t in l){if(!l.hasOwnProperty(t)||!l[t])continue;let o=l[t],n=o.cmd,s="FDM"===a.mode.get();(o.mode?o.mode===a.mode.get():n?s:!s)&&e.push(t)}e=e.sort(),r.deviceClose.onclick=a.dialog.hide,r.deviceSave.onclick=function(){a.function.clear(),a.conf.save(),de()},r.deviceAdd.onclick=function(){a.function.clear(),ee(),de()},r.deviceDelete.onclick=function(){var e;a.function.clear(),e=q(),delete R().devices[e],a.conf.save(),de()},r.deviceAll.onclick=function(){a.show.favorites(!1),de()},r.deviceFavorites.onclick=function(){a.show.favorites(!0),de()},r.deviceSelect.innerHTML="";let s=0,i=a.show.favorites(),d=!1,u=e[0];for(let l=0;l<2;l++)0===s&&e.forEach(function(e,c){1===l&&(i=!1);let p=(m=e,!!R().favorites[m]),_=V(e);var m;if(i&&!p&&!_)return;0===s&&(u=e);let f=n.createElement("option");f.appendChild(n.createTextNode(e)),f.onclick=function(){Q(e)},f.ondblclick=function(){R().favorites[e]?(delete R().favorites[e],a.show.alert(`removed "${e}" from favorites`,3)):(R().favorites[e]=!0,a.show.alert(`added "${e}" to favorites`,3)),de()},_&&f.setAttribute("local",1),(_||p)&&f.setAttribute("favorite",1),r.deviceSelect.appendChild(f),e===o&&(t=s,d=!0),s++});t>=0?(r.deviceSelect.selectedIndex=t,Q(o)):(r.deviceSelect.selectedIndex=0,Q(u)),a.dialog.show("devices",!0),a.dialog.update(),r.deviceSelect.focus()}function ne(){r.toolSelect.innerHTML="",M=0,E.forEach(function(e,t){M=Math.max(M,e.number),e.order=t;let o=n.createElement("option");o.appendChild(n.createTextNode(e.name)),o.onclick=function(){se(e)},r.toolSelect.appendChild(o)})}function se(e){C=e,r.toolName.value=e.name,r.toolNum.value=e.number,r.toolFluteDiam.value=e.flute_diam,r.toolFluteLen.value=e.flute_len,r.toolShaftDiam.value=e.shaft_diam,r.toolShaftLen.value=e.shaft_len,r.toolTaperTip.value=e.taper_tip||0,r.toolMetric.checked=e.metric,r.toolType.selectedIndex=["endmill","ballmill","tapermill"].indexOf(e.type),ae(e)}function ae(e){let t=C.type,o="tapermill"===t;r.toolTaperTip.disabled=o?void 0:"true",$("tool-view").innerHTML='<svg id="tool-svg" width="100%" height="100%"></svg>',setTimeout(()=>{let o=$("tool-svg"),l=o.clientWidth,n=l-20,s=o.clientHeight-20,a=10,i=10,r=e.shaft_len||1,c=e.flute_len||1,d=r+c+("ballmill"===t?e.flute_diam/2:0),u=r/d*s,p=c/d*s,_=Math.max(e.flute_diam,e.shaft_diam,d/4),m=n*(1-e.shaft_diam/_)/2,f=n*(1-e.flute_diam/_)/2,v=n*(1-(e.taper_tip||0)/_)/2,w=[{rect:{x:a+m,y:i,width:n-2*m,height:u,stroke:"#777777",fill:"#cccccc",stroke_width:3}}];if("tapermill"===t){let e=i+u;w.push({path:{stroke_width:3,stroke:"#777777",fill:"#dddddd",d:[`M ${a+f} ${e}`,`L ${a+v} ${e+p}`,`L ${l-a-v} ${e+p}`,`L ${l-a-f} ${e}`,"z"].join("\n")}})}else w.push({rect:{x:a+f,y:i+u,width:n-2*f,height:p,stroke:"#777777",fill:"#dddddd",stroke_width:3}});if("ballmill"===t){let e=(n-2*f)/2,t=l-a-f,o=i+u+p+1.5;w.push({path:{stroke_width:3,stroke:"#777777",fill:"#dddddd",d:[`M ${a+f} ${o}`,`A ${e} ${e} 0 0 0 ${t} ${o}`].join("\n")}})}o.innerHTML=function e(t){if(Array.isArray(t)){let o=[];return t.forEach(t=>o.push(e(t))),o.join("")}let o=[];return Object.keys(t).forEach(e=>{let l=t[e],n=[];Object.keys(l).forEach(e=>{let t=l[e];n.push(`${e.replace(/_/g,"-")}="${t}"`)}),o.push(`<${e} ${n.join(" ")}></${e}>`)}),o.join("")}(w)},10)}function ie(){C.name=r.toolName.value,C.number=parseInt(r.toolNum.value),C.flute_diam=parseFloat(r.toolFluteDiam.value),C.flute_len=parseFloat(r.toolFluteLen.value),C.shaft_diam=parseFloat(r.toolShaftDiam.value),C.shaft_len=parseFloat(r.toolShaftLen.value),C.taper_tip=parseFloat(r.toolTaperTip.value),C.metric=r.toolMetric.checked,C.type=["endmill","ballmill","tapermill"][r.toolType.selectedIndex],ne(),r.toolSelect.selectedIndex=C.order,re(!0),ae(C)}function re(e){E.changed=e,r.toolsSave.disabled=!e}function ce(){if(a.mode.get_id()!==_.CAM)return;E=R().tools.slice().sort((e,t)=>e.name>t.name?1:-1),re(!1),r.toolsClose.onclick=function(){E.changed&&!confirm("abandon changes?")||a.dialog.hide()},r.toolAdd.onclick=function(){E.push({id:Date.now(),number:M+1,name:"new",type:"endmill",shaft_diam:.25,shaft_len:1,flute_diam:.25,flute_len:2,taper_tip:0,metric:!1}),re(!0),ne(),r.toolSelect.selectedIndex=E.length-1,se(E[E.length-1])},r.toolDelete.onclick=function(){E.remove(C),re(!0),ne()},r.toolsSave.onclick=function(){C&&ie(),R().tools=E.sort((e,t)=>e.name<t.name?-1:1),re(!1),a.conf.save(),a.view.update_fields(),a.event.settings()},ne(),E.length>0?(se(E[0]),r.toolSelect.selectedIndex=0):r.toolAdd.onclick(),a.dialog.show("tools"),r.toolSelect.focus()}function de(){D||(a.modal.hide(),a.ajax("/api/filters-"+a.mode.get_lower(),function(e){e&&le(O(e))}))}function ue(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy";let o=w.platform.setColor(65280);65280!==o&&(e=o)}function pe(){w.platform.setColor(e)}function _e(t){t.stopPropagation(),t.preventDefault(),w.platform.setColor(e);let o=t.dataTransfer.files,l=o.length<5||confirm(`add ${o.length} objects to workspace?`),n=o.length<2?void 0:confirm("group files?")?[]:void 0;l&&a.platform.load_files(o,n)}function me(e){a.widgets.load(e.target.getAttribute("load"),function(e){A.add(e),a.dialog.hide()})}function fe(e){z.deleteFile(e.target.getAttribute("del"))}function ve(e){let t=r.catalogList,o=[];t.innerHTML="";for(let t in e)o.push({n:t,ln:t.toLowerCase(),v:e[t].vertices,t:e[t].updated});o.sort(function(e,t){return e.ln<t.ln?-1:1});for(let e=0;e<o.length;e++){let l=n.createElement("div"),s=n.createElement("button"),a=n.createElement("button"),i=o[e],r=i.n;s.setAttribute("load",r),s.setAttribute("title","file: "+r+"\nvertices: "+i.v),s.onclick=me,s.appendChild(n.createTextNode(r.split(".")[0])),a.setAttribute("del",r),a.setAttribute("title","remove '"+r+"'"),a.onclick=fe,a.appendChild(n.createTextNode("x")),l.setAttribute("class","flow-row"),l.appendChild(s),l.appendChild(a),t.appendChild(l)}a.dialog.update()}function we(){a.event.emit("init.one"),a.conf.restore();let e=$("assets"),t=$("control"),o=$("container"),s=($("welcome"),R().controller),_=f.compact||s.compact,v=s.dark;l.addEventListener("resize",a.dialog.update),w.showSkyGrid(!1),w.setSkyColor(v?0:16777215),w.init(o,function(e){0!==a.var.layer_max&&(R().controller.reverseZoom&&(e=-e),e>0?a.var.layer_at--:e<0&&a.var.layer_at++,a.show.slices())}),w.platform.onMove(a.conf.save),w.platform.setRound(!0),w.useDefaultKeys(void 0===a.feature.on_key||a.feature.on_key_defaults),c.setCompact(_),Object.assign(r,{alert:{dialog:$("alert-area"),text:$("alert-text")},container:o,assets:e,control:t,ctrlLeft:$("control-left"),ctrlRight:$("control-right"),layerView:$("layer-view"),layerSlider:$("layer-slider"),modelOpacity:$("opacity"),modal:$("modal"),print:$("print"),local:$("local"),help:$("help"),devices:$("devices"),deviceAdd:$("device-add"),deviceDelete:$("device-del"),deviceSave:$("device-save"),deviceClose:$("device-close"),deviceSelect:$("device-select"),deviceFavorites:$("device-favorites"),deviceAll:$("device-all"),tools:$("tools"),toolsSave:$("tools-save"),toolsClose:$("tools-close"),toolSelect:$("tool-select"),toolAdd:$("tool-add"),toolDelete:$("tool-del"),toolType:$("tool-type"),toolName:$("tool-name"),toolNum:$("tool-num"),toolFluteDiam:$("tool-fdiam"),toolFluteLen:$("tool-flen"),toolShaftDiam:$("tool-sdiam"),toolShaftLen:$("tool-slen"),toolTaperTip:$("tool-ttip"),toolMetric:$("tool-metric"),catalog:$("catalog"),catalogBody:$("catalogBody"),catalogList:$("catalogList"),settings:$("settings"),settingsBody:$("settingsBody"),settingsList:$("settingsList"),layerID:$("layer-id"),layerSpan:$("layer-span"),layerRange:$("layer-range"),loading:$("loading").style,progress:$("progress").style,prostatus:$("prostatus"),selection:$("selection"),sizeX:$("size_x"),sizeY:$("size_y"),sizeZ:$("size_z"),scaleX:$("scale_x"),scaleY:$("scale_y"),scaleZ:$("scale_z"),lockX:$("lock_x"),lockY:$("lock_y"),lockZ:$("lock_z"),stock:$("stock"),stockWidth:$("stock-width"),stockDepth:$("stock-width"),stockHeight:$("stock-width"),device:c.newGroup(u.dv_gr_dev,$("device"),{group:"ddev",nocompact:!0}),deviceName:c.newInput(u.dv_name_s,{title:u.dv_name_l,size:"60%",text:!0,action:oe}),bedWidth:c.newInput(u.dv_bedw_s,{title:u.dv_bedw_l,convert:c.toFloat,size:6}),bedDepth:c.newInput(u.dv_bedd_s,{title:u.dv_bedd_l,convert:c.toFloat,size:6}),maxHeight:c.newInput(u.dv_bedh_s,{title:u.dv_bedh_l,convert:c.toFloat,size:6,modes:I}),deviceMaxSpindle:c.newInput(u.dv_spmx_s,{title:u.dv_spmx_l,convert:c.toInt,modes:y}),deviceOrigin:c.newBoolean(u.dv_orgc_s,P,{title:u.dv_orgc_l,modes:T}),deviceOriginTop:c.newBoolean(u.dv_orgt_s,P,{title:u.dv_orgt_l,modes:y}),deviceRound:c.newBoolean(u.dv_bedc_s,P,{title:u.dv_bedc_l,modes:x}),extruder:c.newGroup(u.dv_gr_ext,$("device"),{group:"dext",nocompact:!0,modes:x}),extFilament:c.newInput(u.dv_fila_s,{title:u.dv_fila_l,convert:c.toFloat,modes:x}),extNozzle:c.newInput(u.dv_nozl_s,{title:u.dv_nozl_l,convert:c.toFloat,modes:x}),extOffsetX:c.newInput(u.dv_exox_s,{title:u.dv_exox_l,convert:c.toFloat,modes:x,expert:!0}),extOffsetY:c.newInput(u.dv_exoy_s,{title:u.dv_exoy_l,convert:c.toFloat,modes:x,expert:!0}),extSelect:c.newText(u.dv_exts_s,{title:u.dv_exts_l,modes:x,size:14,height:3,modes:x,expert:!0}),extrudeAbs:c.newBoolean(u.dv_xtab_s,P,{title:u.dv_xtab_l,modes:x}),extActions:c.newTableRow([[r.extPrev=c.newButton("<"),r.extAdd=c.newButton("+"),r.extDel=c.newButton("-"),r.extNext=c.newButton(">")]],{modes:x,expert:!0}),gcode:c.newGroup(u.dv_gr_gco,$("device"),{group:"dgco",nocompact:!0,modes:T}),gcodeFan:c.newInput(u.dv_fanp_s,{title:u.dv_fanp_l,modes:x,size:"40%",text:!0}),gcodeTrack:c.newInput(u.dv_prog_s,{title:u.dv_prog_l,modes:x,size:"40%",text:!0}),gcodeLayer:c.newText(u.dv_layr_s,{title:u.dv_layr_l,modes:x,size:14,height:2}),gcodeSpace:c.newBoolean(u.dv_tksp_s,P,{title:u.dv_tksp_l,modes:B}),gcodeStrip:c.newBoolean(u.dv_strc_s,P,{title:u.dv_strc_l,modes:y}),gcodeFExt:c.newInput(u.dv_fext_s,{title:u.dv_fext_l,modes:B,size:7,text:!0}),gcodeDwell:c.newText(u.dv_dwll_s,{title:u.dv_dwll_l,modes:y,size:14,height:2}),gcodeChange:c.newText(u.dv_tool_s,{title:u.dv_tool_l,modes:y,size:14,height:2}),gcodeSpindle:c.newText(u.dv_sspd_s,{title:u.dv_sspd_l,modes:y,size:14,height:2}),gcodePause:c.newText(u.dv_paus_s,{title:u.dv_paus_l,modes:x,size:14,height:3}),gcodeLaserOn:c.newText(u.dv_lzon_s,{title:u.dv_lzon_l,modes:L,size:14,height:3}),gcodeLaserOff:c.newText(u.dv_lzof_s,{title:u.dv_lzof_l,modes:L,size:14,height:3}),gcodePre:c.newText(u.dv_head_s,{title:u.dv_head_l,modes:T,size:14,height:3}),gcodePost:c.newText(u.dv_foot_s,{title:u.dv_foot_l,modes:T,size:14,height:3}),mode:c.newGroup(u.mo_menu,e,{region:"left"}),modeTable:c.newTableRow([[r.modeFDM=c.newButton(u.mo_fdmp,function(){a.mode.set("FDM",null,A.update_size)})],[r.modeSLA=c.newButton(u.mo_slap,function(){a.mode.set("SLA",null,A.update_size)})],[r.modeLASER=c.newButton(u.mo_lazr,function(){a.mode.set("LASER",null,A.update_size)})],[r.modeCAM=c.newButton(u.mo_cncm,function(){a.mode.set("CAM",null,A.update_size)},{id:"modeCAM"})]]),system:c.newGroup(u.su_menu),sysTable:c.newTableRow([[r.setupDevices=c.newButton(u.su_devi,de)],[r.setupTools=c.newButton(u.su_tool,ce,{modes:y})],[r.setupExport=c.newButton(u.su_xprt,W,{modes:b,expert:!0})],[r.localButton=c.newButton(u.su_locl,a.show.local,{modes:S,expert:!0})],[r.helpButton=c.newButton(u.su_help,a.help.show)]]),wsFunc:c.newGroup(u.fn_menu),wsFuncTable:c.newTableRow([[r.load=c.newButton(u.fn_impo,function(){a.event.import()},{class:"asym"}),r.import=c.newButton("+",void 0,{class:"asym"})],[r.modeArrange=c.newButton(u.fn_arra,A.layout)],[r.modeSlice=c.newButton(u.fn_slic,a.function.slice)],[r.modePreview=c.newButton(u.fn_prev,a.function.print)],[r.modeExport=c.newButton(u.fn_expo,a.function.export)]]),camera:c.newGroup(u.vu_menu),camTable:c.newTableRow([[c.newButton(u.vu_home,w.view.home),c.newButton(u.vu_rset,w.view.reset)],[c.newButton(u.vu_sptp,w.view.top),c.newButton(u.vu_spfr,w.view.front)],[c.newButton(u.vu_splt,w.view.left),c.newButton(u.vu_sprt,w.view.right)]]),workspace:c.newGroup(u.ws_menu,void 0,{modes:b,expert:!0}),wsTable:c.newTableRow([[r.saveButton=c.newButton(u.ws_save,a.space.save)],[c.newButton(u.ws_cler,a.space.clear)]],{modes:b,expert:!0}),layout:c.newGroup(u.op_menu),expert:c.newBoolean(u.op_xprt_s,N,{title:u.op_xprt_l}),compact:c.newBoolean(u.op_comp_s,N,{title:u.op_comp_l}),dark:c.newBoolean(u.op_dark_s,N,{title:u.op_dark_l}),showOrigin:c.newBoolean(u.op_show_s,N,{title:u.op_show_l,modes:T}),alignTop:c.newBoolean(u.op_alig_s,N,{title:u.op_alig_l,modes:y}),autoLayout:c.newBoolean(u.op_auto_s,N,{title:u.op_auto_l}),freeLayout:c.newBoolean(u.op_free_s,N,{title:u.op_free_l,modes:b,expert:!0}),reverseZoom:c.newBoolean(u.op_invr_s,N,{title:u.op_invr_l,modes:b,expert:!0}),units:c.newSelect(u.op_unit_s,{title:u.op_unit_l,modes:y},"units"),appendLeft:c.checkpoint(),layers:c.setGroup($("layers")),layerOutline:c.newBoolean(u.la_olin,G,{modes:m?b:F}),layerTrace:c.newBoolean(u.la_trce,G,{modes:F}),layerFacing:c.newBoolean(u.la_face,G,{modes:[]}),layerRough:c.newBoolean(u.la_ruff,G,{modes:y}),layerFinish:c.newBoolean(u.la_fini,G,{modes:y}),layerFinishX:c.newBoolean(u.la_finx,G,{modes:y}),layerFinishY:c.newBoolean(u.la_finy,G,{modes:y}),layerDelta:c.newBoolean(u.la_dlta,G,{modes:I}),layerSolid:c.newBoolean(u.la_slds,G,{modes:I}),layerFill:c.newBoolean(u.la_fill,G,{modes:x}),layerSparse:c.newBoolean(u.la_sprs,G,{modes:x}),layerSupport:c.newBoolean(u.la_sprt,G,{modes:I}),layerPrint:c.newBoolean(u.la_prnt,G),layerMoves:c.newBoolean(u.la_move,G,{modes:T}),settingsGroup:c.newGroup(u.se_menu,t,{region:"right"}),settingsTable:c.newTableRow([[r.settingsLoad=c.newButton(u.se_load,U),r.settingsSave=c.newButton(u.se_save,J)]]),process:c.newGroup(u.sl_menu,t,{modes:F}),sliceHeight:c.newInput(u.sl_lahi_s,{title:u.sl_lahi_l,convert:c.toFloat,modes:x}),sliceShells:c.newInput(u.sl_shel_s,{title:u.sl_shel_l,convert:c.toInt,modes:x}),sliceTopLayers:c.newInput(u.sl_ltop_s,{title:u.sl_ltop_l,convert:c.toInt,modes:x}),sliceSolidLayers:c.newInput(u.sl_lsld_s,{title:u.sl_lsld_l,convert:c.toInt,modes:x}),sliceBottomLayers:c.newInput(u.sl_lbot_s,{title:u.sl_lbot_l,convert:c.toInt,modes:x}),process:c.newGroup(u.fi_menu,t,{modes:x}),sliceFillType:c.newSelect(u.fi_type,{modes:x},"infill"),sliceFillSparse:c.newInput(u.fi_pcnt_s,{title:u.fi_pcnt_l,convert:c.toFloat,bound:c.bound(0,1),modes:x}),sliceFillAngle:c.newInput(u.fi_angl_s,{title:u.fi_angl_l,convert:c.toFloat,modes:x,expert:!0}),sliceFillOverlap:c.newInput(u.fi_over_s,{title:u.fi_over_l,convert:c.toFloat,bound:c.bound(0,2),modes:x,expert:!0}),firstLayer:c.newGroup(u.fl_menu,null,{modes:x}),firstSliceHeight:c.newInput(u.fl_lahi_s,{title:u.fl_lahi_l,convert:c.toFloat,modes:x}),firstLayerRate:c.newInput(u.fl_rate_s,{title:u.fl_rate_l,convert:c.toFloat,modes:x}),firstLayerFillRate:c.newInput(u.fl_frat_s,{title:u.fl_frat_l,convert:c.toFloat,modes:x}),firstLayerPrintMult:c.newInput(u.fl_mult_s,{title:u.fl_mult_l,convert:c.toFloat,modes:x,expert:!0}),outputBrimCount:c.newInput(u.fl_skrt_s,{title:u.fl_skrt_l,convert:c.toInt,modes:x}),outputBrimOffset:c.newInput(u.fl_skro_s,{title:u.fl_skro_l,convert:c.toFloat,modes:x}),firstLayerNozzleTemp:c.newInput(u.fl_nozl_s,{title:u.fl_nozl_l,convert:c.toInt,modes:x,expert:!0}),firstLayerBedTemp:c.newInput(u.fl_bedd_s,{title:u.fl_bedd_l,convert:c.toInt,modes:x,expert:!0}),support:c.newGroup(u.sp_menu,null,{modes:x}),sliceSupportDensity:c.newInput(u.sp_dens_s,{title:u.sp_dens_l,convert:c.toFloat,bound:c.bound(.05,1),modes:x}),sliceSupportSize:c.newInput(u.sp_size_s,{title:u.sp_size_l,bound:c.bound(1,200),convert:c.toFloat,modes:x}),sliceSupportOffset:c.newInput(u.sp_offs_s,{title:u.sp_offs_l,bound:c.bound(0,200),convert:c.toFloat,modes:x}),sliceSupportGap:c.newInput(u.sp_gaps_s,{title:u.sp_gaps_l,bound:c.bound(0,5),convert:c.toInt,modes:x,expert:!0}),sliceSupportSpan:c.newInput(u.sp_span_s,{title:u.sp_span_l,bound:c.bound(0,200),convert:c.toFloat,modes:x}),sliceSupportArea:c.newInput(u.sp_area_s,{title:u.sp_area_l,bound:c.bound(.1,200),convert:c.toFloat,modes:x}),sliceSupportExtra:c.newInput(u.sp_xpnd_s,{title:u.sp_xpnd_l,bound:c.bound(0,200),convert:c.toFloat,modes:x,expert:!0}),sliceSupportNozzle:c.newSelect(u.sp_nozl_s,{title:u.sp_nozl_l,modes:x,expert:!0},"extruders"),sliceSupportEnable:c.newBoolean(u.enable,P,{modes:x}),laserOffset:c.newInput(u.ls_offs_s,{title:u.ls_offs_l,convert:c.toFloat,modes:L}),laserSliceHeight:c.newInput(u.ls_lahi_s,{title:u.ls_lahi_l,convert:c.toFloat,modes:L}),laserSliceSingle:c.newBoolean(u.ls_sngl_s,P,{title:u.ls_sngl_l,modes:L}),camCommon:c.newGroup(u.cc_menu,null,{modes:y}),camFastFeed:c.newInput(u.cc_rapd_s,{title:u.cc_rapd_l,convert:c.toInt,modes:y}),roughing:c.newGroup(u.cr_menu,null,{modes:y}),roughingTool:c.newSelect(u.cc_tool,{modes:y}),roughingSpindle:c.newInput(u.cc_spnd_s,{title:u.cc_spnd_l,convert:c.toInt,modes:y}),roughingOver:c.newInput(u.cc_sovr_s,{title:u.cc_sovr_l,convert:c.toFloat,bound:c.bound(.1,1),modes:y}),roughingDown:c.newInput(u.cc_sdwn_s,{title:u.cc_sdwn_l,convert:c.toFloat,modes:y}),roughingSpeed:c.newInput(u.cc_feed_s,{title:u.cc_feed_l,convert:c.toInt,modes:y}),roughingPlunge:c.newInput(u.cc_plng_s,{title:u.cc_plng_l,convert:c.toInt,modes:y}),roughingStock:c.newInput(u.cr_lsto_s,{title:u.cr_lsto_l,convert:c.toFloat,modes:y}),camPocketOnlyRough:c.newBoolean(u.cc_pock_s,P,{title:u.cc_pock_l,modes:y}),camEaseDown:c.newBoolean(u.cr_ease_s,P,{title:u.cr_ease_l,modes:y}),roughingOn:c.newBoolean(u.enable,P,{modes:y}),finishing:c.newGroup(u.cf_menu,null,{modes:y}),finishingTool:c.newSelect(u.cc_tool,{modes:y}),finishingSpindle:c.newInput(u.cc_spnd_s,{title:u.cc_spnd_l,convert:c.toInt,modes:y}),finishingOver:c.newInput(u.cc_sovr_s,{title:u.cc_sovr_l,convert:c.toFloat,bound:c.bound(.05,1),modes:y}),finishingDown:c.newInput(u.cc_sdwn_s,{title:u.cc_sdwn_l,convert:c.toFloat,modes:y}),finishingAngle:c.newInput(u.cf_angl_s,{title:u.cf_angl_l,convert:c.toFloat,bound:c.bound(45,90),modes:y}),finishingSpeed:c.newInput(u.cc_feed_s,{title:u.cc_feed_l,convert:c.toInt,modes:y}),finishingPlunge:c.newInput(u.cc_plng_s,{title:u.cc_plng_l,convert:c.toInt,modes:y}),camPocketOnlyFinish:c.newBoolean(u.cc_pock_s,P,{title:u.cc_pock_l,modes:y}),finishingOn:c.newBoolean(u.cf_watr_s,P,{title:u.cf_watr_l,modes:y}),finishingXOn:c.newBoolean(u.cf_linx_s,P,{title:u.cf_linx_l,modes:y}),finishingYOn:c.newBoolean(u.cf_liny_s,P,{title:u.cf_liny_l,modes:y}),finishCurvesOnly:c.newBoolean(u.cf_curv_s,P,{title:u.cf_curv_l,modes:y}),drilling:c.newGroup(u.cd_menu,null,{modes:y}),drillTool:c.newSelect(u.cc_tool,{modes:y}),drillSpindle:c.newInput(u.cc_spnd_s,{title:u.cc_spnd_l,convert:c.toInt,modes:y}),drillDown:c.newInput(u.cd_plpr_s,{title:u.cd_plpr_l,convert:c.toFloat,modes:y}),drillDownSpeed:c.newInput(u.cc_plng_s,{title:u.cc_plng_l,convert:c.toFloat,modes:y}),drillDwell:c.newInput(u.cd_dwll_s,{title:u.cd_dwll_l,convert:c.toFloat,modes:y}),drillLift:c.newInput(u.cd_lift_s,{title:u.cd_lift_l,convert:c.toFloat,modes:y}),drillingOn:c.newBoolean(u.enable,P,{modes:y}),camTabs:c.newGroup(u.ct_menu,null,{modes:y}),camTabsAngle:c.newInput(u.ct_angl_s,{title:u.ct_angl_l,convert:c.toInt,bound:c.bound(0,360),modes:y}),camTabsCount:c.newInput(u.ct_numb_s,{title:u.ct_numb_l,convert:c.toInt,bound:c.bound(1,20),modes:y}),camTabsWidth:c.newInput(u.ct_wdth_s,{title:u.ct_wdth_l,convert:c.toFloat,bound:c.bound(.1,100),modes:y}),camTabsHeight:c.newInput(u.ct_hght_s,{title:u.ct_hght_l,convert:c.toFloat,bound:c.bound(.1,100),modes:y}),camTabsOn:c.newBoolean(u.enable,P,{title:u.ct_nabl_l,modes:y}),output:c.newGroup(u.fr_menu,null,{modes:x}),outputRaftSpacing:c.newInput(u.fr_spac_s,{title:u.fr_spac_l,convert:c.toFloat,bound:c.bound(0,3),modes:x}),outputRaft:c.newBoolean(u.enable,P,{title:u.fr_nabl_l,modes:x}),output:c.newGroup(u.ou_menu,null,{modes:T}),outputTileSpacing:c.newInput(u.ou_spac_c,{title:u.ou_spac_l,convert:c.toInt,modes:L}),outputTileScaling:c.newInput(u.ou_scal_s,{title:u.ou_scal_l,convert:c.toInt,bound:c.bound(.1,100),modes:L}),outputLaserPower:c.newInput(u.ou_powr_s,{title:u.ou_powr_l,convert:c.toInt,bound:c.bound(1,100),modes:L}),outputLaserSpeed:c.newInput(u.ou_sped_s,{title:u.ou_sped_l,convert:c.toInt,modes:L}),outputLaserMerged:c.newBoolean(u.ou_mrgd_s,P,{title:u.ou_mrgd_l,modes:L}),outputLaserGroup:c.newBoolean(u.ou_grpd_s,P,{title:u.ou_grpd_l,modes:L}),outputTemp:c.newInput(u.ou_nozl_s,{title:u.ou_nozl_l,convert:c.toInt,modes:x}),outputBedTemp:c.newInput(u.ou_bedd_s,{title:u.ou_bedd_l,convert:c.toInt,modes:x}),outputFeedrate:c.newInput(u.ou_feed_s,{title:u.ou_feed_l,convert:c.toInt,modes:x}),outputFinishrate:c.newInput(u.ou_fini_s,{title:u.ou_fini_l,convert:c.toInt,modes:x}),outputSeekrate:c.newInput(u.ou_move_s,{title:u.ou_move_l,convert:c.toInt,modes:x}),outputShellMult:c.newInput(u.ou_shml_s,{title:u.ou_exml_l,convert:c.toFloat,bound:c.bound(0,2),modes:x}),outputFillMult:c.newInput(u.ou_flml_s,{title:u.ou_exml_l,convert:c.toFloat,bound:c.bound(0,2),modes:x}),outputSparseMult:c.newInput(u.ou_spml_s,{title:u.ou_exml_l,convert:c.toFloat,bound:c.bound(0,2),modes:x}),outputFanLayer:c.newInput(u.ou_fanl_s,{title:u.ou_fanl_l,convert:c.toInt,bound:c.bound(0,100),modes:x,expert:!0}),camTolerance:c.newInput(u.ou_toll_s,{title:u.ou_toll_l,convert:c.toFloat,bound:c.bound(.001,1),modes:y}),camZTopOffset:c.newInput(u.ou_ztof_s,{title:u.ou_ztof_l,convert:c.toFloat,modes:y}),camZBottom:c.newInput(u.ou_zbot_s,{title:u.ou_zbot_l,convert:c.toFloat,modes:y}),camZClearance:c.newInput(u.ou_zclr_s,{title:u.ou_zclr_l,convert:c.toFloat,bound:c.bound(.01,100),modes:y}),outputClockwise:c.newBoolean(u.ou_conv_s,P,{title:u.ou_conv_l,modes:y}),camDepthFirst:c.newBoolean(u.ou_depf_s,P,{title:u.ou_depf_l,modes:y}),camStock:c.newGroup(u.cs_menu,null,{modes:y}),camStockX:c.newInput(u.cs_wdth_s,{title:u.cs_wdth_l,convert:c.toFloat,bound:c.bound(0,9999),modes:y}),camStockY:c.newInput(u.cs_dpth_s,{title:u.cs_dpth_l,convert:c.toFloat,bound:c.bound(0,9999),modes:y}),camStockZ:c.newInput(u.cs_hght_s,{title:u.cs_hght_l,convert:c.toFloat,bound:c.bound(0,9999),modes:y}),camStockOffset:c.newBoolean(u.cs_offs_s,P,{title:u.cs_offs_l,modes:y}),outputOriginBounds:c.newBoolean(u.or_bnds_s,P,{title:u.or_bnds_l,modes:L}),outputOriginCenter:c.newBoolean(u.or_cntr_s,P,{title:u.or_cntr_l,modes:B}),camOriginTop:c.newBoolean(u.or_topp_s,P,{title:u.or_topp_l,modes:y}),advanced:c.newGroup(u.ad_menu,null,{modes:x,expert:!0}),outputRetractDist:c.newInput(u.ad_rdst_s,{title:u.ad_rdst_l,convert:c.toFloat,modes:x,expert:!0}),outputRetractSpeed:c.newInput(u.ad_rrat_s,{title:u.ad_rrat_l,convert:c.toInt,modes:x,expert:!0}),outputRetractDwell:c.newInput(u.ad_rdwl_s,{title:u.ad_rdwl_l,convert:c.toInt,modes:x,expert:!0}),outputCoastDist:c.newInput(u.ad_scst_s,{title:u.ad_scst_l,bound:c.bound(0,10),convert:c.toFloat,modes:x,expert:!0}),sliceSolidMinArea:c.newInput(u.ad_msol_s,{title:u.ad_msol_l,convert:c.toFloat,modes:x,expert:!0}),sliceMinHeight:c.newInput(u.ad_minl_s,{title:u.ad_minl_l,bound:c.bound(0,3),convert:c.toFloat,modes:x,expert:!0}),outputMinSpeed:c.newInput(u.ad_mins_s,{title:u.ad_mins_l,bound:c.bound(5,200),convert:c.toFloat,modes:x,expert:!0}),outputShortPoly:c.newInput(u.ad_spol_s,{title:u.ad_spol_l,bound:c.bound(0,200),convert:c.toFloat,modes:x,expert:!0}),zHopDistance:c.newInput(u.ad_zhop_s,{title:u.ad_zhop_l,bound:c.bound(0,3),convert:c.toFloat,modes:x,expert:!0}),antiBacklash:c.newInput(u.ad_abkl_s,{title:u.ad_abkl_l,bound:c.bound(0,3),convert:c.toInt,modes:x,expert:!0}),sliceRotation:m?c.newInput(u.ad_slrt_s,{title:u.ad_slrt_l,bound:c.bound(-45,45),convert:c.toFloat,modes:x,expert:!0}):null,gcodePauseLayers:c.newInput(u.ag_paws_s,{title:u.ag_paws_l,modes:x,expert:!0,comma:!0}),outputLayerRetract:c.newBoolean(u.ad_lret_s,P,{title:u.ad_lret_l,modes:x,expert:!0}),slaProc:c.newGroup(u.ad_menu,null,{modes:k,group:"sla-slice"}),slaSlice:c.newInput(u.sa_lahe_s,{title:u.sa_lahe_l,convert:c.toFloat,modes:k}),slaShell:c.newInput(u.sa_shel_s,{title:u.sa_shel_l,convert:c.toFloat,modes:k}),slaOpenTop:c.newBoolean(u.sa_otop_s,P,{title:u.sa_otop_l,modes:k}),slaOpenBase:c.newBoolean(u.sa_obas_s,P,{title:u.sa_obas_l,modes:k}),slaOutput:c.newGroup(u.sa_layr_m,null,{modes:k,group:"sla-layers"}),slaLayerOn:c.newInput(u.sa_lton_s,{title:u.sa_lton_l,convert:c.toFloat,modes:k}),slaLayerOff:c.newInput(u.sa_ltof_s,{title:u.sa_ltof_l,convert:c.toFloat,modes:k,expert:!0}),slaPeelDist:c.newInput(u.sa_pldi_s,{title:u.sa_pldi_l,convert:c.toFloat,modes:k}),slaPeelLiftRate:c.newInput(u.sa_pllr_s,{title:u.sa_pllr_l,convert:c.toFloat,modes:k,expert:!0}),slaPeelDropRate:c.newInput(u.sa_pldr_s,{title:u.sa_pldr_l,convert:c.toFloat,modes:k,expert:!0}),slaOutput:c.newGroup(u.sa_base_m,null,{modes:k,group:"sla-base"}),slaBaseLayers:c.newInput(u.sa_balc_s,{title:u.sa_balc_l,convert:c.toInt,modes:k}),slaBaseOn:c.newInput(u.sa_lton_s,{title:u.sa_bltn_l,convert:c.toFloat,modes:k}),slaBaseOff:c.newInput(u.sa_ltof_s,{title:u.sa_bltf_l,convert:c.toFloat,modes:k,expert:!0}),slaBasePeelDist:c.newInput(u.sa_pldi_s,{title:u.sa_pldi_l,convert:c.toFloat,modes:k}),slaBasePeelLiftRate:c.newInput(u.sa_pllr_s,{title:u.sa_pllr_l,convert:c.toFloat,modes:k,expert:!0}),slaFill:c.newGroup(u.sa_infl_m,null,{modes:k,group:"sla-infill"}),slaFillDensity:c.newInput(u.sa_ifdn_s,{title:u.sa_ifdn_l,convert:c.toFloat,bound:c.bound(0,1),modes:k}),slaFillLine:c.newInput(u.sa_iflw_s,{title:u.sa_iflw_l,convert:c.toFloat,bound:c.bound(0,5),modes:k}),slaSupport:c.newGroup(u.sa_supp_m,null,{modes:k,group:"sla-support"}),slaSupportLayers:c.newInput(u.sa_slyr_s,{title:u.sa_slyr_l,convert:c.toInt,bound:c.bound(5,100),modes:k}),slaSupportGap:c.newInput(u.sa_slgp_s,{title:u.sa_slgp_l,convert:c.toInt,bound:c.bound(3,30),modes:k,expert:!0}),slaSupportDensity:c.newInput(u.sa_sldn_s,{title:u.sa_sldn_l,convert:c.toFloat,bound:c.bound(.01,.9),modes:k}),slaSupportSize:c.newInput(u.sa_slsz_s,{title:u.sa_slsz_l,convert:c.toFloat,bound:c.bound(.1,1),modes:k}),slaSupportPoints:c.newInput(u.sa_slpt_s,{title:u.sa_slpt_l,convert:c.toInt,bound:c.bound(3,10),modes:k,expert:!0}),slaSupportEnable:c.newBoolean(u.enable,P,{title:u.sl_slen_l,modes:k}),slaOutput:c.newGroup(u.sa_outp_m,null,{modes:k,group:"sla-first"}),slaFirstOffset:c.newInput(u.sa_opzo_s,{title:u.sa_opzo_l,convert:c.toFloat,bound:c.bound(0,1),modes:k,expert:!0}),slaAntiAlias:c.newSelect(u.sa_opaa_s,{title:u.sa_opaa_l,modes:k},"antialias")}),ge||(r.setupDevices.innerHTML="D<u>e</u>vices",r.setupTools.innerHTML="T<u>o</u>ols",r.modeArrange.innerHTML="<u>A</u>rrange",r.modeSlice.innerHTML="<u>S</u>lice",r.modePreview.innerHTML="<u>P</u>review",r.modeExport.innerHTML="E<u>x</u>port");let h=$("langpop"),D=n.createElement("div"),O=n.createElement("div");function C(e){let t=parseFloat(e.target.value||1)/parseFloat(e.target.was||1),o=parseFloat(r.sizeX.was),l=parseFloat(r.sizeY.was),n=parseFloat(r.sizeZ.was),s=r.lockX.checked?t:1,i=r.lockY.checked?t:1,c=r.lockZ.checked?t:1;a.selection.scale(s,i,c),r.sizeX.was=r.sizeX.value=o*s,r.sizeY.was=r.sizeY.value=l*i,r.sizeZ.was=r.sizeZ.value=n*c}function E(e){let t=parseFloat(e.target.value||1)/parseFloat(e.target.was||1),o=parseFloat(r.scaleX.was),l=parseFloat(r.scaleY.was),n=parseFloat(r.scaleZ.was),s=r.lockX.checked?t:1,i=r.lockY.checked?t:1,c=r.lockZ.checked?t:1;a.selection.scale(s,i,c),r.scaleX.was=r.scaleX.value=o*s,r.scaleY.was=r.scaleY.value=l*i,r.scaleZ.was=r.scaleZ.value=n*c}function M(e){let t=parseFloat(e.target.value)*g;switch(e.target.value=0,e.target.id.split("").pop()){case"x":return a.selection.rotate(t,0,0);case"y":return a.selection.rotate(0,t,0);case"z":return a.selection.rotate(0,0,t)}}var H;D.appendChild(n.createTextNode("english")),O.appendChild(n.createTextNode("danish")),h.appendChild(D),h.appendChild(O),D.onclick=function(){i.setItem("kiri-lang","en-us"),a.space.reload()},O.onclick=function(){i.setItem("kiri-lang","da-dk"),a.space.reload()},w.addEventHandlers(self,["keyup",j,"keydown",X,"keypress",Y,"dragover",ue,"dragleave",pe,"drop",_e]),w.onEnterKey([r.layerSpan,function(){a.show.slices()},r.layerID,function(){a.show.layer(r.layerID.value)},r.scaleX,E,r.scaleY,E,r.scaleZ,E,r.sizeX,C,r.sizeY,C,r.sizeZ,C,r.toolName,ie,r.toolNum,ie,r.toolFluteDiam,ie,r.toolFluteLen,ie,r.toolShaftDiam,ie,r.toolShaftLen,ie,r.toolTaperTip,ie,$("rot_x"),M,$("rot_y"),M,$("rot_z"),M]),r.layerID.convert=c.toFloat.bind(r.layerID),r.layerSpan.convert=c.toFloat.bind(r.layerSpan),r.layerRange.onclick=function(){r.layerRange.checked=!r.layerRange.checked,a.show.slices()},$("layer-toggle").onclick=function(e){let t=r.layers.style;t.display="block"!==t.display?"block":"none",r.layers.style.left=e.target.getBoundingClientRect().left+"px"},r.modelOpacity.onchange=r.modelOpacity.onclick=function(e){a.widgets.opacity(parseInt(r.modelOpacity.value)/100)},r.layerSlider.ondblclick=function(){r.layerRange.checked=!r.layerRange.checked,a.show.slices()},r.layerSlider.onmousedown=function(e){e.shiftKey&&(r.layerRange.checked=!r.layerRange.checked)},r.layerSlider.onclick=function(){a.show.layer(r.layerSlider.value)},r.layerSlider.onmousemove=r.layerSlider.onchange=function(){a.show.layer(r.layerSlider.value)},r.layerSlider.onmouseup=function(){a.focus()},r.import.setAttribute("import","1"),r.import.onclick=function(){c.hidePoppers(),a.dialog.show("catalog")},$("cache-close").onclick=a.dialog.hide,r.toolMetric.onclick=ie,r.toolType.onchange=ie,$("apphelp").onclick=a.help.show,w.platform.setSize(R().device.bedWidth,R().device.bedDepth,R().device.bedHeight),_&&r.selection.classList.add("compact"),v?(w.platform.setGrid(25,5,10066329,3355443),w.platform.opacity(.8),n.body.classList.add("dark")):(w.platform.setGrid(25,5,10066329,13421772),w.platform.opacity(.3)),w.mouse.downSelect(function(e,t){if(e&&(t.ctrlKey||t.metaKey||a.feature.on_face_select)){let t=new THREE.Quaternion;t.setFromUnitVectors(e.face.normal,new THREE.Vector3(0,0,-1)),a.selection.rotate(t)}return a.view.get()!==p.ARRANGE?null:a.selection.meshes()}),w.mouse.upSelect(function(e,t){if(!t||"CANVAS"!==t.target.nodeName)return a.widgets.meshes();e?A.select(e.object.widget,t.shiftKey):A.deselect()}),w.mouse.onDrag(function(e){if(!e||!r.freeLayout.checked)return a.selection.meshes().length>0;{let t=R(),o=t.device,l=t.bounds,n=o.bedWidth/2,s=o.bedDepth/2;if(l.min.x+e.x<=-n)return;if(l.min.y+e.y<=-s)return;if(l.max.x+e.x>=n)return;if(l.max.y+e.y>=s)return;a.selection.for_widgets(function(t){t.move(e.x,e.y,0),a.event.emit("widget.move",{widget:t,delta:e})}),A.update_stock()}}),a.space.restore(he)||(H=he,!i[d]&&(i[d]=(new Date).getTime(),!f.s&&a.feature.seed)&&(A.load_stl("/obj/cube.stl",function(e){z.putFile("sample cube.stl",e),A.compute_max_z(),w.view.home(),setTimeout(a.space.save,500),H(),a.help.show()}),1))||he()}function he(){a.event.emit("init.two");let e=R(),o=e.controller;if(w.scene.freeze(!0),A.deselect(),z.addFileListener(ve),w.view.setZoom(o.reverseZoom,o.zoomSpeed),w.platform.setZOff(.2),r.showOrigin.checked=o.showOrigin,r.freeLayout.checked=o.freeLayout,r.autoLayout.checked=o.autoLayout,r.alignTop.checked=o.alignTop,r.reverseZoom.checked=o.reverseZoom,r.compact.checked=o.compact,f.s&&f.s.forEach(function(e){let t=n.createElement("script");t.setAttribute("defer",!0),t.setAttribute("src","/code/"+e+".js"),n.body.appendChild(t),h.add("load_"+e),a.event.emit("load.lib",e)}),f.ss&&f.ss.forEach(function(e){e="/"===e.charAt(0)?e:`/kiri/style-${e}`;let t=n.createElement("link");t.setAttribute("type","text/css"),t.setAttribute("rel","stylesheet"),t.setAttribute("href",`${e}.css`),n.body.appendChild(t)}),f.v&&f.v.forEach(function(e){e=e.split("="),i.setItem(e[0],e[1])}),f.ophost){let e=a.const.OCTO={host:f.ophost[0],apik:f.opkey?f.opkey[0]:""};i["octo-host"]=e.host,i["octo-apik"]=e.apik,console.log({octoprint:e})}let l=f.mode?f.mode[0]:null,s=f.dev?f.dev[0]:null;a.mode.set(l||v||e.mode,l),A.update_size(),a.focus(),r.helpButton.title=`${u.version} `+t.version,c.setExpert(o.expert),Q(s||a.device.get(),s),a.conf.update(),K(),setInterval(a.event.alerts,1e3),r.alert.dialog.onclick=function(){a.event.alerts(!0)},a.view.set(p.ARRANGE),a.show.controls(a.feature.controls),a.dialog.update(),a.show.alert(`${u.version} ${t.version}`),f.s||console.log(`kiri | init main | ${t.version}`),a.event.emit("init-done",h),w.scene.freeze(!1)}a.show.devices=de,a.device.set=Q;let ge=void 0,be=f.ln?f.ln[0]:i.getItem("kiri-lang")||t.lang.get();if(be&&"en"!==be&&"en-us"!==be){ge=be;let e=n.createElement("script");e.setAttribute("src",`/kiri/lang/${be}.js`),(n.body||n.head).appendChild(e),h.set("ll",be),e.onload=function(){t.lang.set(be),we()},e.onerror=function(e){console.log({language_load_error:e,lang:be}),we()}}t.lang.set(),ge||("loading"===document.readyState?w.addEventListener(n,"DOMContentLoaded",we):we())}();