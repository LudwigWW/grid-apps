"use strict";var gs_base_point=exports;!function(){if(self.base||(self.base={}),!self.base.Point){var t=self.base,i=t.util,n=t.config,s=t.key,r=i.round,o=e.prototype;t.Point=e,t.newPoint=u,o.setZ=function(t){return this.z=t,this},o.swapXZ=function(){var t=this,i=t.x;t.x=t.z,t.z=i},o.swapYZ=function(){var t=this,i=t.y;t.y=t.z,t.z=i},o.round=function(t){return u(r(this.x,t),r(this.y,t),r(this.z,t))},o.addFacet=function(t){return this.group||(this.group=[]),this.group.push(t),this},o.rekey=function(){this.key=[this.x,this.y,this.z].join(",")},o.toString=function(){return this.key},o.clone=function(){return u(this.x,this.y,this.z,this.key)},o.slopeTo=function(i){return t.newSlope(this,i)},o.lineTo=function(i,n){return t.newLine(this,i,n)},o.isNear=function(t,n){return i.isCloseTo(this.x,t.x,n)&&i.isCloseTo(this.y,t.y,n)},o.distToLine=function(t,i){return Math.sqrt(this.distToLineSq(t,i))},o.distToLineNew=function(t,i){return function(t,i,n){var s={x:n.x-i.x,y:n.y-i.y},r=h({x:t.x-i.x,y:t.y-i.y},s),o=h(s,s),e=r/o;isNaN(e)&&(e=0);var u={x:i.x+e*s.x,y:i.y+e*s.y};return function(t,i){return function(t){return Math.sqrt(h(t,t))}({x:t.x-i.x,y:t.y-i.y})}(t,u)}(this,t,i)},o.distToLineSq=function(t,n){var s=this,r=i.distSq(t,n),o=((s.x-t.x)*(n.x-t.x)+(s.y-t.y)*(n.y-t.y))/r;return o<0?i.distSq(s,t):o>1?i.distSq(s,n):i.distSqv2(s.x,s.y,t.x+o*(n.x-t.x),t.y+o*(n.y-t.y))},o.withinDist2=function(t,i,n){var s=t.distToSq2D(i),r=this.distToSq2D(t),o=this.distToSq2D(i);return!(s<n&&r>(s+=n)&&o>s)&&(!(r>s&&o>s)&&this.distToLineSq(t,i)<n)},o.midPointTo=function(t){return u((this.x+t.x)/2,(this.y+t.y)/2,this.z)},o.midPointTo3D=function(t){return u((this.x+t.x)/2,(this.y+t.y)/2,(this.z+t.z)/2)},o.projectOnSlope=function(t,i){return u(this.x+t.dx*i,this.y+t.dy*i,this.z)},o.followTo=function(t,i){return this.follow(this.slopeTo(t),i)},o.offsetPointFrom=function(t,i){var n=t.x-this.x,r=t.y-this.y,o=i/Math.sqrt(n*n+r*r),e=n*o,h=r*o;return u(t.x-e,t.y-h,t.z,s.NONE)},o.offsetPointTo=function(t,i){let n=t.x-this.x,r=t.y-this.y;if(0===n&&0===r)return this;let o=i/Math.sqrt(n*n+r*r),e=n*o,h=r*o;return u(this.x+e,this.y+h,t.z,s.NONE)},o.offsetLineTo=function(i,n){var r=this,o=i.x-r.x,e=i.y-r.y,h=n/Math.sqrt(o*o+e*e),y=o*h,f=e*h,x=u(r.x-f,r.y+y,r.z,s.NONE),c=u(i.x-f,i.y+y,i.z,s.NONE);return x.op=r,c.op=i,t.newLine(x,c,s.NONE)},o.offset=function(t,i,n){return u(this.x+t,this.y+i,this.z+n)},o.inPolygon=function(t){if(!t.bounds.containsXY(this.x,this.y))return!1;var i,n,s,r=t.points,o=r.length,e=!1;for(s=0;s<o;s++)i=r[s],n=r[(s+1)%o],i.y>=this.y!=n.y>=this.y&&this.x<=(n.x-i.x)*(this.y-i.y)/(n.y-i.y)+i.x&&(e=!e);return e},o.isInPolygon=function(t){var i;if(Array.isArray(t)){for(i=0;i<t.length;i++)if(this.isInPolygon(t[i]))return!0;return!1}var s=t.inner;if(this.inPolygon(t)||this.nearPolygon(t,n.precision_merge_sq)){for(i=0;s&&i<s.length;i++)if(this.inPolygon(s[i])&&!this.nearPolygon(s[i],n.precision_merge_sq))return!1;return!0}return!1},o.isInPolygonOnly=function(t){var i;if(Array.isArray(t)){for(i=0;i<t.length;i++)if(this.isInPolygonOnly(t[i]))return!0;return!1}var n=t.inner;if(this.inPolygon(t)){for(i=0;n&&i<n.length;i++)if(this.inPolygon(n[i]))return!1;return!0}return!1},o.nearPolygon=function(t,i,n){for(var s=0,r=t.points,o=r.length;s<o;s++)if(this.withinDist2(r[s],r[(s+1)%o],i))return!0;if(n&&t.inner)for(s=0;s<t.inner.length;s++)if(this.nearPolygon(t.inner[s],i))return!0;return!1},o.insideOffset=function(t,i,n){return this.inPolygon(t)===i>0&&!this.nearPolygon(t,n)},o.follow=function(t,i){var n=i/Math.sqrt(t.dx*t.dx+t.dy*t.dy);return u(this.x+t.dx*n,this.y+t.dy*n,this.z)},o.intersectZ=function(t,i){var n=t.x-this.x,s=t.y-this.y,r=t.z-this.z,o=1-(t.z-i)/r;return u(this.x+n*o,this.y+s*o,this.z+r*o)},o.isEqual2D=function(t){return this===t||this.x===t.x&&this.y===t.y},o.isMergable2D=function(t){return this.isEqual2D(t)||this.distToSq2D(t)<n.precision_merge_sq},o.isEqual=function(t){return this===t||this.x===t.x&&this.y===t.y&&this.z===t.z},o.isMergable3D=function(t){return this.isEqual(t)||this.distToSq3D(t)<n.precision_merge_sq},o.isInBox=function(t,i){return Math.abs(this.x-t.x)<i&&Math.abs(this.y-t.y)<i},o.distToPolySegments=function(t,i){var n=this,s=1/0;return t.forEachSegment(function(t,r){const o=Math.min(s,n.distToLine(t,r));if((s=Math.min(o,s))<=i)return!0}),s},o.distToPolyPoints=function(t,i){var n=this,s=1/0;return t.forEachPoint(function(t){if((s=Math.min(s,n.distTo2D(t)))<i)return!0}),s},o.nearestTo=function(t,i){if(!i)throw"missing max";var n,s,r,o=1/0,e=null;for(n=0;n<t.length;n++)(s=t[n])===this||s.del||(r=this.distToSq2D(s))<i&&r<o&&(o=r,e=s);return e},o.averageDistTo=function(t){var i,n=0,s=0;for(i=0;i<t.length;i++)t[i]!=this&&(n+=this.distToSq2D(t[i]),s++);return n/s},o.distTo2D=function(t){var i=this.x-t.x,n=this.y-t.y;return Math.sqrt(i*i+n*n)},o.distToSq2D=function(t){var i=this.x-t.x,n=this.y-t.y;return i*i+n*n},o.distTo3D=function(t){var i=this.x-t.x,n=this.y-t.y,s=this.z-t.z;return Math.sqrt(i*i+n*n+s*s)},o.distToSq3D=function(t){var i=this.x-t.x,n=this.y-t.y,s=this.z-t.z;return i*i+n*n+s*s},o.inTriangle=function(t,i,n){var s=this.x-t.x,r=this.y-t.y,o=(i.x-t.x)*r-(i.y-t.y)*s>0;return(n.x-t.x)*r-(n.y-t.y)*s>0!=o&&(n.x-i.x)*(this.y-i.y)-(n.y-i.y)*(this.x-i.x)>0==o},o.onLine=function(t,i){return this.distToLine(t,i)<n.precision_point_on_line},o.add=function(t){return u(this.x+t.x,this.y+t.y,this.z+t.z)},o.sub=function(t){return u(this.x-t.x,this.y-t.y,this.z-t.z)},o.move=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.X+=t.x*n.clipper,this.Y+=t.y*n.clipper,this}}function e(t,i,s,r,o){o?(this.x=t||o.X/n.clipper||0,this.y=i||o.Y/n.clipper||0,this.z=s||0,this.X=o.X,this.Y=o.Y,this.key=null):(this.x=t,this.y=i,this.z=s||0,this.X=t*n.clipper,this.Y=i*n.clipper,this.key=r||[t,i,s].toString()),this.poly=null,this.dist=0,this.p1=null,this.p2=null,this.pos=0,this.mod=0,this.del=!1,this.group=null}function h(t,i){return t.x*i.x+t.y*i.y}function u(t,i,n,s,r){return new e(t,i,n,s,r)}}();